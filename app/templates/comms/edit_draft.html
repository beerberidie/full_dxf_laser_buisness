{% extends "base.html" %}

{% block title %}Edit Draft - Laser OS{% endblock %}

{% block content %}
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-lg-8 offset-lg-2">
            <!-- Header -->
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1>
                    <i class="fas fa-edit me-2"></i>Edit Draft
                </h1>
                <a href="{{ url_for('comms.drafts') }}" class="btn btn-outline-secondary">
                    <i class="fas fa-arrow-left me-2"></i>Back to Drafts
                </a>
            </div>

            <!-- Draft Info Card -->
            <div class="card mb-4">
                <div class="card-header bg-light">
                    <h5 class="mb-0">
                        <i class="fas fa-info-circle me-2"></i>Draft Information
                    </h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        {% if draft.client %}
                        <div class="col-md-6 mb-2">
                            <strong>Client:</strong>
                            <a href="{{ url_for('clients.view_client', id=draft.client_id) }}">
                                {{ draft.client.name }}
                            </a>
                        </div>
                        {% endif %}
                        
                        {% if draft.project %}
                        <div class="col-md-6 mb-2">
                            <strong>Project:</strong>
                            <a href="{{ url_for('projects.view_project', id=draft.project_id) }}">
                                {{ draft.project.project_code }}
                            </a>
                        </div>
                        {% endif %}
                        
                        <div class="col-md-6 mb-2">
                            <strong>Created:</strong>
                            {{ draft.created_at.strftime('%Y-%m-%d %H:%M') }}
                        </div>
                        
                        <div class="col-md-6 mb-2">
                            <strong>Status:</strong>
                            {% if draft.sent %}
                            <span class="badge bg-success">Sent</span>
                            {% else %}
                            <span class="badge bg-warning text-dark">Pending</span>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Edit Form -->
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-envelope me-2"></i>Message Content
                    </h5>
                </div>
                <div class="card-body">
                    <form method="POST">
                        <!-- Channel -->
                        <div class="mb-3">
                            <label for="channel_hint" class="form-label">
                                <i class="fas fa-share-alt me-1"></i>Channel
                            </label>
                            <select class="form-select" id="channel_hint" name="channel_hint" required>
                                <option value="whatsapp" {% if draft.channel_hint == 'whatsapp' %}selected{% endif %}>
                                    WhatsApp
                                </option>
                                <option value="email" {% if draft.channel_hint == 'email' %}selected{% endif %}>
                                    Email
                                </option>
                            </select>
                        </div>
                        
                        <!-- Message Body -->
                        <div class="mb-3">
                            <label for="body_text" class="form-label">
                                <i class="fas fa-comment me-1"></i>Message Text
                            </label>
                            <textarea class="form-control" 
                                      id="body_text" 
                                      name="body_text" 
                                      rows="10" 
                                      required>{{ draft.body_text }}</textarea>
                            <small class="form-text text-muted">
                                Edit the message content as needed before sending.
                            </small>
                        </div>
                        
                        <!-- Actions -->
                        <div class="d-flex justify-content-between">
                            <a href="{{ url_for('comms.drafts') }}" class="btn btn-secondary">
                                <i class="fas fa-times me-2"></i>Cancel
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-save me-2"></i>Save Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

