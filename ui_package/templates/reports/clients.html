{% extends "base.html" %}

{% block title %}Client Report - Reports - Laser OS{% endblock %}

{% block content %}
<div class="page-header">
    <h1>üë• Client & Project Report</h1>
    <div class="page-actions">
        <a href="{{ url_for('reports.index') }}" class="btn btn-secondary">‚Üê Back to Reports</a>
    </div>
</div>

<!-- Statistics Cards -->
<div class="grid grid-4" style="margin-bottom: 2rem;">
    <div class="card stat-card">
        <div class="stat-value">{{ stats.total_clients }}</div>
        <div class="stat-label">Total Clients</div>
    </div>
    <div class="card stat-card">
        <div class="stat-value">{{ stats.total_projects }}</div>
        <div class="stat-label">Total Projects</div>
    </div>
    <div class="card stat-card">
        <div class="stat-value">${{ "%.2f"|format(stats.total_value) }}</div>
        <div class="stat-label">Total Project Value</div>
    </div>
    <div class="card stat-card">
        <div class="stat-value">${{ "%.2f"|format(stats.avg_value_per_client) }}</div>
        <div class="stat-label">Avg Value per Client</div>
    </div>
</div>

<!-- Client Data Table -->
<div class="card">
    <div class="card-header">
        <h2>Client Analysis</h2>
    </div>
    <div class="card-body">
        {% if client_data %}
        <table class="table">
            <thead>
                <tr>
                    <th>Client Code</th>
                    <th>Client Name</th>
                    <th>Total Projects</th>
                    <th>Active Projects</th>
                    <th>Total Value</th>
                    <th>Laser Runs</th>
                    <th>Cut Hours</th>
                </tr>
            </thead>
            <tbody>
                {% for data in client_data %}
                <tr>
                    <td>
                        <a href="{{ url_for('clients.detail', id=data.client.id) }}">
                            {{ data.client.client_code }}
                        </a>
                    </td>
                    <td>{{ data.client.name }}</td>
                    <td>{{ data.project_count }}</td>
                    <td>
                        {% if data.active_projects > 0 %}
                        <span class="badge badge-success">{{ data.active_projects }}</span>
                        {% else %}
                        {{ data.active_projects }}
                        {% endif %}
                    </td>
                    <td><strong>${{ "%.2f"|format(data.total_value) }}</strong></td>
                    <td>{{ data.total_runs }}</td>
                    <td>{{ data.total_cut_hours }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="text-muted">No client data available.</p>
        {% endif %}
    </div>
</div>

<style>
.stat-card {
    text-align: center;
    padding: 1.5rem;
}

.stat-value {
    font-size: 2rem;
    font-weight: bold;
    color: var(--color-primary);
}

.stat-label {
    color: var(--text-secondary);
    margin-top: 0.5rem;
    font-size: 0.875rem;
}

.badge-success {
    background-color: var(--success-color);
    color: white;
}
</style>
{% endblock %}

